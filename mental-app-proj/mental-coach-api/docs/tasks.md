# משימות פרויקט mental-coach-api

## 21/05/2024

### בעיות שזוהו:
- [x] פורט 5000 תפוס על ידי תהליך אחר
- [ ] מפתח SendGrid אינו מוגדר כראוי בקובץ .env

### פתרונות:
- [x] זוהה תהליך ControlCenter (PID 777) שתפס את פורט 5000 והתהליך חוסל
- [ ] יש להגדיר מפתח SendGrid תקין בקובץ .env שמתחיל ב-SG.

### משימות נוספות:
- [ ] יצירת קובץ CHANGELOG.md לתיעוד שינויים
- [ ] יצירת קולקציית Postman עבור ה-API
- [ ] תיעוד מבנה הקבצים והתפקיד של כל קובץ/תיקייה
- [ ] רשימת ספריות קוד פתוח בשימוש כולל גרסאות ורישיונות

## 22/01/2025

### בעיות שזוהו:
- [x] שגיאות 500 בנתיבים `/training-programs` במקום `/api/training-programs`
- [x] נתונים לא נכונים מה-API של תוכניות האימון

### פתרונות:
- [x] הוספת לוגים מפורטים לזיהוי בעיות:
  - [x] לוג כללי לכל בקשה נכנסת ב-server.ts
  - [x] לוגים ב-middleware של האימות (appAuthMiddleware)
  - [x] לוגים בקונטרולר של training-programs
  - [x] לוגים ב-error handler
  - [x] לוגים ב-routes של training-programs
  - [x] הוספת רשימת נתיבים זמינים בהודעת 404
- [x] זוהתה הבעיה: הלקוח פונה לנתיבים ללא הקידומת `/api`
- [x] הוספת redirects אוטומטיים מנתיבים ללא `/api` לנתיבים עם `/api`
- [x] החלפת נתוני הדמה בנתונים האמיתיים:
  - [x] יצירת קובץ נתונים חדש: `data/training-program-data.ts`
  - [x] עדכון הקונטרולר להחזיר את הנתונים החדשים
  - [x] מחיקת נתונים ישנים מהמסד
  - [x] יצירת סקריפטים להטמעת הנתונים החדשים

### הושלם בהצלחה:
- [x] תוכנית האימון "מנטליות של ווינר I - המעטפת המנטלית" עם 24 שיעורים
- [x] שיעור מבוא עם תוכן מלא
- [x] שיעורים 1-3 עם תוכן מפורט כולל וידאו, מדיטציות ותרגילים
- [x] שיעור 14 עם תוכן מלא על התמודדות עם פחד מדעת אחרים
- [x] שאר השיעורים מוגדרים כ"בפיתוח" עם כותרות וסטטוס מתאים

### המלצות:
- כדאי להריץ את השרת ולבדוק את הלוגים החדשים כדי לזהות את מקור הבעיה
- נראה שיש בקשות שמגיעות לנתיב לא נכון (`/training-programs` במקום `/api/training-programs`)
- הלוגים יעזרו לזהות האם הבעיה היא בצד הלקוח או בצד השרת
- יצרתי קובץ הנחיות לתיקון בצד הלקוח: `documentation/frontend-api-fix-instructions.md`
- הנתונים החדשים מוטמעים ומוכנים לשימוש

## 23/01/2025

### משימות שהושלמו:
- [x] יצירת קולקשן Postman מלא עם כל הקריאות במערכת
- [x] יצירת מדריך אימות מפורט למערכת (Authentication-Guide.md)
- [x] הוספת נתיב `/api/lessons` עם פונקציונליות מלאה
- [x] תיקון בעיות הרשאות במערכת האימון
- [x] הוספת תמיכה במנוי "basic" לתוכניות האימון
- [x] יצירת קובץ קולקשן Postman: `documentation/Postman-Collection-Mental-Coach-API.json`

### קבצים שנוצרו:
- `documentation/Postman-Collection-Mental-Coach-API.json` - קולקשן מלא עם כל הקריאות
- `documentation/Authentication-Guide.md` - מדריך מפורט לתהליך האימות

### תיקונים שבוצעו:
- תיקון בעיות TypeScript בקונטרולר lessons
- הוספת פונקציה `getAllLessons` לקבלת שיעורים לפי תוכנית
- תיקון גישה לנתונים הרדקודים במבנה הנכון
- עדכון הרשאות גישה לתמיכה במנוי basic

### הערות טכניות:
- הקולקשן כולל סקריפטים אוטומטיים לניהול טוקני אימות
- המדריך מסביר את כל תהליכי האימות והרשאות במערכת
- הנתיבים מוגדרים עם משתנים לגמישות בשימוש

### תיקונים נוספים (23/01/2025):
- [x] תיקון נתיב `/api/training-programs/{id}/lessons` להחזרת רשימה בסיסית
- [x] הפרדה בין גישה לרשימת שיעורים לתוכן מפורט של שיעור
- [x] הוספת שדה `hasAccess` לכל שיעור ברשימה
- [x] עדכון המדריך להסביר את ההבדל בין סוגי הגישה
- [x] עדכון קולקשן Postman עם הנתיב החדש

## 01/07/2025

### בעיות שתוקנו:
- [x] **בעיה קריטית: השיעורים לא נשמרו במסד הנתונים**
  - זוהתה הבעיה: הסקריפט לא הכניס את השיעורים למסד
  - נוצר קובץ `scripts/training-lessons-data.mjs` עם כל נתוני השיעורים
  - עודכן `scripts/seed-real-training-data.mjs` להכנסת השיעורים
  - נוסף סקריפט `seed:real-training` ל-package.json

### משימות שהושלמו:
- [x] הכנסת כל 24 השיעורים של תוכנית "מנטליות של ווינר I" למסד הנתונים
- [x] קישור השיעורים לתוכנית האימון במסד
- [x] עדכון CHANGELOG.md עם השינויים החדשים
- [x] עדכון קובץ המשימות הנוכחי

### פרטים טכניים:
- השיעורים כוללים תוכן מלא עבור שיעורים 0-3 ושיעור 14
- שאר השיעורים (4-13, 15-23) מוגדרים כ"תוכן בפיתוח"
- כל השיעורים כוללים הגדרות גישה, ניקוד ומבנה מלא
- הסקריפט מוחק נתונים קיימים לפני הכנסת הנתונים החדשים 

## [2025-01-02] ביטול זמני של בדיקות הרשאות
- [x] ביטול בדיקות הרשאות בכל הקונטרולרים של מערכת הקורסים
- [x] כל המשתמשים יכולים לגשת לכל התוכן בתקופת הבדיקות
- [x] השדה hasAccess מוחזר כ-true לכולם

## [2025-01-02] תיקון בעיות טכניות 